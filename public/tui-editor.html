<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TUI Image Editor</title>
    <!-- TUI Image Editor CSS -->
    <link rel="stylesheet" href="https://uicdn.toast.com/tui-image-editor/latest/tui-image-editor.css">
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        h1 {
            text-align: center;
            color: #333;
            margin-bottom: 30px;
        }
        #tui-image-editor {
            width: 100%;
            height: 700px;
            border: 2px solid #ddd;
            border-radius: 8px;
        }
        .controls {
            margin-bottom: 20px;
            text-align: center;
        }
        .controls input, .controls button {
            margin: 0 10px;
            padding: 10px 20px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        .controls button {
            background: #007bff;
            color: white;
            cursor: pointer;
        }
        .controls button:hover {
            background: #0056b3;
        }
        .controls button:disabled {
            background: #ccc;
            cursor: not-allowed;
        }
        #result {
            margin-top: 20px;
            text-align: center;
        }
        #result img {
            max-width: 100%;
            border: 2px solid #ddd;
            border-radius: 8px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>TUI Image Editor - API Mode</h1>
        
        <div class="controls">
            <input type="file" id="imageInput" accept="image/*">
            <button id="uploadBtn" disabled>Upload Image</button>
            <button id="grayscaleBtn" disabled>Apply Grayscale</button>
        </div>
        
        <div id="tui-image-editor"></div>
        
        <div id="result">
            <h3>Result:</h3>
            <img id="resultImage" style="display: none;">
        </div>
    </div>

    <!-- TUI Image Editor JavaScript -->
    <script src="https://uicdn.toast.com/tui-image-editor/latest/tui-image-editor.js"></script>
    
    <script>
        // Initialize the image editor without UI
        var editor = new tui.ImageEditor(document.querySelector('#tui-image-editor'), {
            cssMaxWidth: 700,
            cssMaxHeight: 500,
            selectionStyle: {
                cornerSize: 20,
                rotatingPointOffset: 70
            }
        });

        // Get DOM elements
        const imageInput = document.getElementById('imageInput');
        const uploadBtn = document.getElementById('uploadBtn');
        const grayscaleBtn = document.getElementById('grayscaleBtn');
        const resultImage = document.getElementById('resultImage');

        let currentImageUrl = null;

        // Enable upload button when file is selected
        imageInput.addEventListener('change', function(e) {
            uploadBtn.disabled = !e.target.files.length;
        });

        // Handle file upload
        uploadBtn.addEventListener('click', async function() {
            const file = imageInput.files[0];
            if (!file) return;

            // Create object URL for the file
            currentImageUrl = URL.createObjectURL(file);
            
            try {
                // Load the image into the editor
                await editor.loadImageFromURL(currentImageUrl, file.name);
                console.log('Image loaded!');
                
                // Enable grayscale button
                grayscaleBtn.disabled = false;
                
            } catch (error) {
                console.error('Error loading image:', error);
                alert('Error loading image. Please try again.');
            }
        });

        // Apply grayscale filter
        async function applyGrayscale() {
            try {
                // Apply the grayscale filter
                editor.applyFilter('Grayscale');
                console.log('Grayscale filter applied!');

                // Get the result as a Base64 data URL
                const dataURL = editor.toDataURL();

                // Display the result
                resultImage.src = dataURL;
                resultImage.style.display = 'block';
                console.log('Result displayed!');

            } catch (error) {
                console.error('Error applying grayscale:', error);
                alert('Error applying grayscale filter.');
            }
        }

        // Add event listener for grayscale button
        grayscaleBtn.addEventListener('click', applyGrayscale);

        // Black theme configuration (keeping for reference)
        var blackTheme = {
            'common.bi.image': 'https://uicdn.toast.com/toastui/img/tui-image-editor-bi.png',
            'common.bisize.width': '251px',
            'common.bisize.height': '21px',
            'common.backgroundImage': 'none',
            'common.backgroundColor': '#1e1e1e',
            'common.border': '0px',
            
            // header
            'header.backgroundImage': 'none',
            'header.backgroundColor': 'transparent',
            'header.border': '0px',
            
            // load button
            'loadButton.backgroundColor': '#fff',
            'loadButton.border': '1px solid #ddd',
            'loadButton.color': '#222',
            'loadButton.fontFamily': 'NotoSans, sans-serif',
            'loadButton.fontSize': '12px',
            
            // download button
            'downloadButton.backgroundColor': '#fdba3b',
            'downloadButton.border': '1px solid #fdba3b',
            'downloadButton.color': '#fff',
            'downloadButton.fontFamily': 'NotoSans, sans-serif',
            'downloadButton.fontSize': '12px',
            
            // main icons
            'menu.normalIcon.color': '#8a8a8a',
            'menu.activeIcon.color': '#555555',
            'menu.disabledIcon.color': '#434343',
            'menu.hoverIcon.color': '#e9e9e9',
            'menu.iconSize.width': '24px',
            'menu.iconSize.height': '24px',
            
            // submenu icons
            'submenu.normalIcon.color': '#8a8a8a',
            'submenu.activeIcon.color': '#e9e9e9',
            'submenu.iconSize.width': '32px',
            'submenu.iconSize.height': '32px',
            
            // submenu primary color
            'submenu.backgroundColor': '#1e1e1e',
            'submenu.partition.color': '#3c3c3c',
            
            // submenu labels
            'submenu.normalLabel.color': '#8a8a8a',
            'submenu.normalLabel.fontWeight': 'lighter',
            'submenu.activeLabel.color': '#fff',
            'submenu.activeLabel.fontWeight': 'lighter',
            
            // checkbox style
            'checkbox.border': '1px solid #ccc',
            'checkbox.backgroundColor': '#fff',
            
            // rango style
            'range.pointer.color': '#fff',
            'range.bar.color': '#666',
            'range.subbar.color': '#d1d1d1',
            
            'range.disabledPointer.color': '#414141',
            'range.disabledBar.color': '#282828',
            'range.disabledSubbar.color': '#414141',
            
            'range.value.color': '#fff',
            'range.value.fontWeight': 'lighter',
            'range.value.fontSize': '11px',
            'range.value.border': '1px solid #353535',
            'range.value.backgroundColor': '#151515',
            'range.title.color': '#fff',
            'range.title.fontWeight': 'lighter',
            
            // colorpicker style
            'colorpicker.button.border': '1px solid #1e1e1e',
            'colorpicker.title.color': '#fff'
        };
    </script>
</body>
</html>